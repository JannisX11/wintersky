import{Object3D as e,Texture as t,NearestFilter as i,Vector3 as a,Euler as r,Plane as s,PlaneGeometry as o,Mesh as n,BufferAttribute as l,Quaternion as c,Line3 as p,Sphere as h,ShaderMaterial as _,Vector2 as m,FrontSide as d,DoubleSide as f,AdditiveBlending as g,NormalBlending as u,CubicBezierCurve as A,SplineCurve as v}from"three";import y from"molangjs";import x from"tinycolor2";var b={};b.Scene=class{constructor(t={}){this.emitters=[],this.child_configs={},this.space=new e,this._fetchTexture=t.fetchTexture,this._fetchParticleFile=t.fetchParticleFile,this.global_options={max_emitter_particles:t.max_emitter_particles||3e4,tick_rate:t.tick_rate||30,loop_mode:t.loop_mode||"auto",parent_mode:t.parent_mode||"world",ground_collision:0!=t.ground_collision,_scale:1},Object.defineProperty(this.global_options,"scale",{get:()=>this.global_options._scale,set:e=>{this.global_options._scale=e,this.emitters.forEach((t=>{t.local_space.scale.set(e,e,e),t.global_space.scale.set(e,e,e)}))}})}fetchTexture(e){if("function"==typeof this._fetchTexture)return this._fetchTexture(e)}fetchParticleFile(e,t){if("function"==typeof this._fetchParticleFile)return this._fetchParticleFile(e,t)}updateFacingRotation(e){this.emitters.forEach((t=>{t.updateFacingRotation(e)}))}};const M="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4QcKDTg2HKzkwgAAAFBJREFUOMtjvHDhwn8GCgALAwMDg4iICFma37x5w8DEQCEg2gBpaWkGaWlp8g2g2AVDyABcgTUwXiDGNQMfiCzoAk+fPiXIpr4L3rx5Q7YBAOhLE0zw8k9cAAAAAElFTkSuQmCC";function w(e){if("string"==typeof e&&"#"==e[0])e.length<9&&(e="#ff"+e.substr(1,6));else{if(e instanceof Array)return new x({r:255*(e[0]||0),g:255*(e[1]||0),b:255*(e[2]||0),a:"number"==typeof e[3]?e[3]:1}).toHex8String();e=new x(e).toHex8String()}return"#"+e.substr(3,6)+e.substr(1,2)}class C{constructor(e,i,a=0){this.scene=e,this.texture=new t(new Image),this.texture.image.onload=()=>{this.texture.needsUpdate=!0,"function"==typeof this.onTextureUpdate&&this.onTextureUpdate()},this.texture_source_category="placeholder",this.reset(),this.onTextureUpdate=null,a.path&&this.set("file_path",a.path),i&&i.particle_effect?this.setFromJSON(i):"object"==typeof i&&Object.assign(this,i)}reset(){for(var e in this.texture.image.src=M,this.texture.magFilter=i,this.texture.minFilter=i,C.types){var t,a=C.types[e];switch(a.type){case"string":case"molang":t="";break;case"number":t=0;break;case"boolean":t=!1;break;case"color":t="#ffffff";break;case"object":t={}}if(a.array){if(this[e]=[],a.dimensions)for(var r=0;r<a.dimensions;r++)"object"==a.type&&(t={}),this[e].push(t)}else if("object"==a.type&&this[e])for(let t in this[e])delete this[e][t];else this[e]=t}return this.emitter_rate_mode="steady",this.emitter_lifetime_mode="looping",this.emitter_shape_mode="point",this.particle_appearance_material="particles_alpha",this.particle_appearance_facing_camera_mode="rotate_xyz",this.particle_appearance_direction_mode="derive_from_velocity",this.particle_appearance_speed_threshold=.01,this.particle_direction_mode="outwards",this.particle_motion_mode="dynamic",this.particle_rotation_mode="dynamic",this.particle_texture_mode="static",this.particle_color_mode="static",this.particle_color_interpolant="v.particle_age / v.particle_lifetime",this.particle_color_range=1,this.emitter_rate_rate="4",this.emitter_rate_amount="1",this.emitter_rate_maximum="100",this.emitter_lifetime_active_time="1",this.particle_appearance_size=["0.2","0.2"],this.particle_lifetime_max_lifetime="1",this.particle_texture_size=[16,16],this.texture_source_category="placeholder",this}set(e,t){if(null!=C.types[e]&&null!=t&&null!=t){if(C.types[e].array&&t instanceof Array)"molang"==C.types[e].type&&(t=t.map((e=>e.toString()))),this[e].splice(0,1/0,...t);else if(C.types[e].array&&"string"==C.types[e].type&&"string"==typeof t)this[e].splice(0,1/0,t);else if("string"==typeof this[e])this[e]=t.toString();else if("number"==C.types[e].type&&"number"==typeof t)this[e]=t;else if("boolean"==C.types[e].type)this[e]=!!t;else if("object"==C.types[e].type)for(let i in t)this[e][i]=t[i];return this}}setFromJSON(e){var t=e.particle_effect.components,i=e.particle_effect.curves,a=e.particle_effect.events,r=e.particle_effect.description;if(r&&r.identifier&&(this.identifier=r.identifier),r&&r.basic_render_parameters&&(this.set("particle_texture_path",r.basic_render_parameters.texture),this.set("particle_appearance_material",r.basic_render_parameters.material)),"object"==typeof a)for(let e in a){let t=a[e];this.events[e]=t}if(i)for(var s in i){var o=i[s],n={id:s,mode:o.type,input:(o.input||0).toString(),range:(o.horizontal_range||0).toString(),nodes:[]};if(o.nodes instanceof Array&&o.nodes.length)o.nodes.forEach((e=>{let t=parseFloat(e)||0;n.nodes.push(t)}));else if("object"==typeof o.nodes&&"bezier_chain"==o.type)for(let e in o.nodes){let t=o.nodes[e],i={time:parseFloat(e),left_value:parseFloat(t.left_value||t.value)||0,right_value:parseFloat(t.right_value||t.value)||0,left_slope:parseFloat(t.left_slope||t.slope)||0,right_slope:parseFloat(t.right_slope||t.slope)||0};n.nodes.push(i)}this.curves[s]=n}if(t){function l(e){return t["minecraft:"+e]}if(l("emitter_initialization")){var c=l("emitter_initialization").creation_expression,p=l("emitter_initialization").per_update_expression;"string"==typeof c&&(this.variables_creation_vars=c.replace(/;+$/,"").split(";")),"string"==typeof p&&(this.variables_tick_vars=p.replace(/;+$/,"").split(";"))}if(l("emitter_local_space")&&(this.space_local_position=l("emitter_local_space").position,this.space_local_rotation=l("emitter_local_space").rotation,this.space_local_velocity=l("emitter_local_space").velocity),l("emitter_rate_manual")&&(this.set("emitter_rate_mode","manual"),this.set("emitter_rate_maximum",l("emitter_rate_manual").max_particles)),l("emitter_rate_steady")&&(this.set("emitter_rate_mode","steady"),this.set("emitter_rate_rate",l("emitter_rate_steady").spawn_rate),this.set("emitter_rate_maximum",l("emitter_rate_steady").max_particles)),l("emitter_rate_instant")&&(this.set("emitter_rate_mode","instant"),this.set("emitter_rate_amount",l("emitter_rate_instant").num_particles)),l("emitter_lifetime_once")&&(this.set("emitter_lifetime_mode","once"),this.set("emitter_lifetime_active_time",l("emitter_lifetime_once").active_time)),l("emitter_lifetime_looping")&&(this.set("emitter_lifetime_mode","looping"),this.set("emitter_lifetime_active_time",l("emitter_lifetime_looping").active_time),this.set("emitter_lifetime_sleep_time",l("emitter_lifetime_looping").sleep_time)),l("emitter_lifetime_expression")&&(this.set("emitter_lifetime_mode","expression"),this.set("emitter_lifetime_activation",l("emitter_lifetime_expression").activation_expression),this.set("emitter_lifetime_expiration",l("emitter_lifetime_expression").expiration_expression)),l("emitter_lifetime_events")){let e=l("emitter_lifetime_events");this.set("emitter_events_creation",e.creation_event),this.set("emitter_events_expiration",e.expiration_event),this.set("emitter_events_timeline",e.timeline),this.set("emitter_events_distance",e.travel_distance_events),this.set("emitter_events_distance_looping",e.looping_travel_distance_events)}var h,_=l("emitter_shape_point")||l("emitter_shape_custom");if(_&&(this.set("emitter_shape_mode","point"),this.set("emitter_shape_offset",_.offset)),l("emitter_shape_sphere")&&(_=l("emitter_shape_sphere"),this.set("emitter_shape_mode","sphere"),this.set("emitter_shape_offset",_.offset),this.set("emitter_shape_radius",_.radius),this.set("emitter_shape_surface_only",_.surface_only)),l("emitter_shape_box")&&(_=l("emitter_shape_box"),this.set("emitter_shape_mode","box"),this.set("emitter_shape_offset",_.offset),this.set("emitter_shape_half_dimensions",_.half_dimensions),this.set("emitter_shape_surface_only",_.surface_only)),l("emitter_shape_disc")){switch(_=l("emitter_shape_disc"),this.set("emitter_shape_mode","disc"),this.set("emitter_shape_offset",_.offset),_.plane_normal){case"x":this.set("emitter_shape_plane_normal",[1,0,0]);break;case"y":this.set("emitter_shape_plane_normal",[0,1,0]);break;case"z":this.set("emitter_shape_plane_normal",[0,0,1]);break;default:this.set("emitter_shape_plane_normal",_.plane_normal)}this.set("emitter_shape_radius",_.radius),this.set("emitter_shape_surface_only",_.surface_only)}if(l("emitter_shape_entity_aabb")&&(this.set("emitter_shape_mode","entity_aabb"),this.set("emitter_shape_surface_only",l("emitter_shape_entity_aabb").surface_only),_=l("emitter_shape_entity_aabb")),_&&_.direction&&("inwards"==_.direction||"outwards"==_.direction?this.set("particle_direction_mode",_.direction):(this.set("particle_direction_mode","direction"),this.set("particle_direction_direction",_.direction))),l("particle_initialization")){p=l("particle_initialization").per_update_expression;var m=l("particle_initialization").per_render_expression;"string"==typeof p&&(this.particle_update_expression=p.replace(/;+$/,"").split(";")),"string"==typeof m&&(this.particle_render_expression=m.replace(/;+$/,"").split(";"))}if(l("particle_initial_spin")&&(this.set("particle_rotation_initial_rotation",l("particle_initial_spin").rotation),this.set("particle_rotation_rotation_rate",l("particle_initial_spin").rotation_rate)),l("particle_kill_plane")&&this.set("particle_lifetime_kill_plane",l("particle_kill_plane")),l("particle_motion_dynamic")){let e=l("particle_motion_dynamic").linear_acceleration,t=l("particle_motion_dynamic").linear_drag_coefficient,i=l("particle_motion_dynamic").rotation_acceleration,a=l("particle_motion_dynamic").rotation_drag_coefficient;null==e&&null==t||(this.set("particle_motion_mode","dynamic"),this.set("particle_motion_linear_acceleration",e),this.set("particle_motion_linear_drag_coefficient",t),this.set("particle_motion_linear_speed",1)),null==e&&null==t||(this.set("particle_rotation_mode","dynamic"),this.set("particle_rotation_rotation_acceleration",i),this.set("particle_rotation_rotation_drag_coefficient",a))}else this.set("particle_motion_mode","static");if(l("particle_motion_parametric")){let e=l("particle_motion_parametric").relative_position,t=l("particle_motion_parametric").direction,i=l("particle_motion_parametric").rotation;null==e&&null==t||(this.set("particle_motion_mode","parametric"),this.set("particle_motion_relative_position",e),this.set("particle_motion_direction",t)),null!=i&&(this.set("particle_rotation_mode","parametric"),this.set("particle_rotation_rotation",i))}if(this.set("particle_collision_toggle",null!=l("particle_motion_collision")),l("particle_motion_collision")&&(this.set("particle_collision_enabled",l("particle_motion_collision").enabled),this.set("particle_collision_collision_drag",l("particle_motion_collision").collision_drag),this.set("particle_collision_coefficient_of_restitution",l("particle_motion_collision").coefficient_of_restitution),this.set("particle_collision_collision_radius",l("particle_motion_collision").collision_radius),this.set("particle_collision_expire_on_contact",l("particle_motion_collision").expire_on_contact),l("particle_motion_collision").events)){let e=l("particle_motion_collision").events;e instanceof Array?this.set("particle_collision_events",e):"object"==typeof e&&this.set("particle_collision_events",[e])}if(void 0!==l("particle_initial_speed"))"object"!=typeof(h=l("particle_initial_speed"))?this.set("particle_motion_linear_speed",h):(this.set("particle_direction_mode","direction"),this.set("particle_direction_direction",l("particle_initial_speed")),this.set("particle_motion_linear_speed",1));if(l("particle_lifetime_expression")&&(this.set("particle_lifetime_max_lifetime",l("particle_lifetime_expression").max_lifetime||""),this.set("particle_lifetime_expiration_expression",l("particle_lifetime_expression").expiration_expression||0)),l("particle_expire_if_in_blocks")instanceof Array&&this.set("particle_lifetime_expire_in",l("particle_expire_if_in_blocks")),l("particle_expire_if_not_in_blocks")instanceof Array&&this.set("particle_lifetime_expire_outside",l("particle_expire_if_not_in_blocks")),l("particle_appearance_billboard")){this.set("particle_appearance_size",l("particle_appearance_billboard").size),this.set("particle_appearance_facing_camera_mode",l("particle_appearance_billboard").facing_camera_mode);var{direction:d,uv:f}=l("particle_appearance_billboard");d&&(this.set("particle_appearance_direction_mode",d.mode),this.set("particle_appearance_speed_threshold",d.min_speed_threshold),this.set("particle_appearance_direction",d.custom_direction)),f?(f.texture_width&&this.set("particle_texture_size",[f.texture_width,f.texture_height]),f.flipbook?(this.set("particle_texture_mode","animated"),this.set("particle_texture_uv",f.flipbook.base_UV),this.set("particle_texture_uv_size",f.flipbook.size_UV),this.set("particle_texture_uv_step",f.flipbook.step_UV),this.set("particle_texture_frames_per_second",f.flipbook.frames_per_second),this.set("particle_texture_max_frame",f.flipbook.max_frame),this.set("particle_texture_stretch_to_lifetime",f.flipbook.stretch_to_lifetime),this.set("particle_texture_loop",f.flipbook.loop)):1==f.texture_width&&1==f.texture_height&&f.uv&&!f.uv[0]&&!f.uv[1]&&f.uv_size&&1==f.uv_size[0]&&1==f.uv_size[1]?(this.set("particle_texture_mode","full"),this.set("particle_texture_uv",f.uv),this.set("particle_texture_uv_size",f.uv_size)):(this.set("particle_texture_mode","static"),this.set("particle_texture_uv",f.uv),this.set("particle_texture_uv_size",f.uv_size))):this.set("particle_texture_mode","full")}if(l("particle_appearance_lighting")&&this.set("particle_color_light",!0),l("particle_appearance_tinting"))if("string"==typeof(h=l("particle_appearance_tinting").color))this.set("particle_color_static",w(h));else if(h instanceof Array&&h.length>=3)if((typeof h[0]+typeof h[1]+typeof h[2]+typeof h[3]).includes("string"))this.set("particle_color_mode","expression"),this.set("particle_color_expression",h);else{this.set("particle_color_mode","static");var g=new x({r:255*h[0],g:255*h[1],b:255*h[2],a:h[3]}).toHex8String();this.set("particle_color_static",g)}else if("object"==typeof h){this.set("particle_color_mode","gradient"),this.set("particle_color_interpolant",h.interpolant);let e=[];if(h.gradient instanceof Array){let t=100/(h.gradient.length-1);h.gradient.forEach(((i,a)=>{i=w(i);var r=t*a;e.push({percent:r,color:i})}))}else if("object"==typeof h.gradient){let t=1;for(var u in h.gradient)t=Math.max(parseFloat(u),t);for(var u in this.set("particle_color_range",t),h.gradient){g=w(h.gradient[u]);var A=parseFloat(u)/t*100;e.push({color:g,percent:A})}}this.set("particle_color_gradient",e)}if(l("particle_lifetime_events")){let e=l("particle_lifetime_events");this.set("particle_events_creation",e.creation_event),this.set("particle_events_expiration",e.expiration_event),this.set("particle_events_timeline",e.timeline)}}return this.updateTexture(),this}updateTexture(){let e=e=>{if(e)this.texture_source_category="loaded";else switch(this.particle_texture_path){case"textures/particle/particles":e="data:image/png;base64,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",this.texture_source_category="built_in";break;case"textures/flame_atlas":case"textures/particle/flame_atlas":e="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAIACAYAAACLuuzTAAAphElEQVR42u3dB7RlVZUu4EMVoUCigIqAZFBybBAapSU1oii0NNqNoG0b29buNiuIICVBcs65iCI556DknHMoMlSRKhF372+uvc45t+7ap6qe743n6/H2GHvce6vOnnuFOf/5z7nmWqdTVVXnL7k7fz0C9pin0znhE53Osct0Oscs3emctnqnc9bfdjrnbNCpTluj0/nD2p3O2et3Osct2+n8ft7OcAH7zt/pnLhCEnD0UrWA+qFzPt2pzv27TnXmJ9PD532mU51aC95n/oKAQxbudE5fMwk5Yfn09vM36lQXfbZTXbZlp7pym5mqSz7Xqcas1NICb71os07lwTPX7XTu3mVUdeeOs1W3/WyW6k/fHFHd+L2R1Z+/PaI6eeVOdHeYgCOX6HSu+vJM8abrvj6ienLMotVLV61fPXniwtXtP5+1uvXHtaB/HVGdvlans/+HCgIM4P17fqC65T9mrm74zsjqkcPmr164ZM3quQtWru7b/QPVg/vPUz17zieqsz/V6RxQEmDAnjp50Wi25t7z29mjFa/e/pXq8WM/Uj165ILVA/vMVV27/UwxK8ME3PmrWSvXkyctUt29y+zVs+euUD134Srxb+9OvLcW/rFolfE4/uMFAXf8ctbqjQe+Xz1/4arVwwfPF/ebj/yseuXPm1VPn7Z4dd8eH6hu/dHMMRaXbOGRqQRcsfVM1RPHLVQ9fNB81U3fH1lNefn06o0Hf1hNePRX1S3/OXPlBXf9erYYyD+uW2jBDd8ZEc196er1q7t3HhW/v3rbP1YP7D1X1X89csgHqyMW65RtQZ89fOcOs3UfmPTMQdU7b95Yt+Y/qtfv+df8z+3GZJT13/X0GUvGYF7+D53qoQPmqa7/lxFVqzHtNFunc+TiyQ4YE5s4frlatWu1HlNr3ymr1feqnXZr/O0cnc5RS9YClkxCPHjyKp3Oqauln26CWgX8bs705qOWSPdJKybjYsb0nyB/twrYc57UbA/rird5mCnTvDP+Jv2uZXuWjGm/BeuHalM9dtkkyNv+uF6nc24NKBdskswaHhiX3ecqCDi0xgOG4kFvpBfuP31jRMVKr/7nmaqrakulxrpbBJSLa8C4ePNOTNsDe81VPV5r5v2/n7O64bs1FnwrCdLKvecrCND3W/9r5pjra7ebKUz4iRM+Wj1+zIcDD+6s1fjB/eYOPNjngwUBms1cb/7hzGGyt/10lurhA+etnjtvxTBjxsQWLv1CpzpuuYIAb31r3LnVQzVwsLpHDp0/WvDmwz+pXrtz2zCye383RyAWfRkm4LqvjaheunK9gLB7R88eXXjxinVrRFqleuyoD1V37TSquvHfRkYXi9Z44aad7luA58vXbRQCXrr6U2HeN/9gZHRPC2jlMAGXbxUgEchzxy8SOr14+TrREteUl8+oJjy2Q3VPjVaHLVoQYKCeOmWxMOXbayh/d9ID8eBrd21fTXzq9/U4bFeNv2Wr6t0pj4eFFs35tp/MUl2z7UzV/Xuktz7zx2Wrp09dPObfuMBDyDwQD7Tk0cPnjxlx6X++Xrh0rXY8+M2oTkffjvhYfS+W7IGvyK7OTY33r21mx1kLY7DLHOnBwz+WbkYTQLJqEnTSCsnYqDzsKOIBM/awlpzw8fQwb+zBU1ZJvwObojHxuHx/4MES6aEAlHUanvDp2rzXTag1+gMFARymBzw4pkajK76UHK2frPTSLRImgLxdSwI4TGTCfeHfd8Kt00o6YWpN5SWfrw2pbuXuc7cAynW1FfJQV3ypE9rIqfDYnO1N/z4yLFQLi5Bmmm6vH2IshDCce3advXqs9srM2P+xBbBmoIcJwE4YDquDPhgKAHnhsr8J7SNMCyDWoYsUBOjfU6cuFkTCB7l7rt794L5zV9T8+hofL/9S4knDBJiq+3abI/qeKQ7LZAtaxCvrnhkxkMMEnFv3jfN8cL95guaEbzx9ya6nHnfD5mHeN9f/d/BHCwIMGgaiqfjAhMd3TphwxSdrmrNNDTAbBsCMv23rGNRiC1jeVV+ZKT7w9uvXRAseO/rD4RPuqMdEVx49YsHQlTZzjnkHrBMe+3X1zhs3hE94d/IjXf701rjzqmmR7fqtHwqH4s3U18zQypvT2LTwg1HJVPNN59k/ZwobjDwTp/Kwo8gPKMgh9QgbZa7ew9w8QTQVJjD1Ih7sNlcy5cMXTR/yEIXJvIB7hwf+b5eSgL3ma95WN5PrumDjZJX8Bf0/b8NOhc16wc6zFwTs/cFEKAAIN0/zDBokvuyLnTBlQrRydBseXPrFBBpuimXub//5LOGt3VRZ63YrEQxQRVGu/McEHHwlrbx3tzR9MIGNaOUBHy4IwH/MP5u/+p9mCnu46zejgv7y1IRhLGKoA0sC9PuhA+aNh2gfQcwYR4ANukSwQYXMwwlGPUUI9U21F6aB4IxAHvu6ryWOBGTNSJErn1FTl7FnLhOGxL1zqqzz9sZTo/wCD+ylOAYiM64ceN5QD9grf9q0wYQl6tBnjfDIY89cukatxQOlh7dg7TT3ABXFef3ebwXFQbI94N/oBKM6c51CC+C+y4CBtnE3f6Eaf/OW8dAr129cTX7uyDDzV/60SfXOhNvLeMClT372sKD7uhPmXKM1RAZtuvfIoR8cjAfPnrt8gvL6J3dmIA2cgaWNA/HgoI90Oge661E+YvEeDuT4AY/2mYF4cHCDB5QlAKXhBSg/PDhooRYBGHjQ/SXTnSP2iKU/mVw7TDi4FrBTSYCAGolAKvBhbl2fGRe6z5TRf63cpQ0PfEh8ALY9zAIZEA7pvmyrhAe7ztFC9+k613V+jUbe7OHwiTUOXPPV5PqNxd4ltg7OzDWbBywe4qH4CcplGmmkcShmMAAm1w4HvE2kIpIPt163gmDdMKjIyDABIJwpc+EYCiu8u8YG3BgOiGIE3WbETAzvQj3HACQCjnoAx/5h6bAJcDb+1q0DXPyte/suUE5ABMXJPOCZPy5TTXnh+IAzPvGJ4xeKJAQeLTkzTABtu6Y2HhAuBYIXMxzmqws52JA/6A+Bu79csGmKF9A6lF/uRDegMyR6/uLVY0yeqCMarGWYANb3xv3fj4zF/XvOGeaLK/BOhPIP9OLe0XO08wMY4G3PnrN8wDn/cNdOs8X8m1qgYzYG4gHYNp0eFICZEdQOjPFYA+MFtg5x3eIGJh2YsFwybXggXvj1bIVBRKAjXlg0UX4jLRh1c/E0lR0g5cWAQwwQROITCUDMiigVJsIFeECYVrbiAdeecwb03uCFO6tngkBWCg+K/EDTvI3r8kYzQED22ByPQTQee8zdkg4EIJDI2zzEsOgAe7i60VLjUMwn6r/wlrqaa0pkOsOt196aDmiBcSimA7XAwx7UfA8BFC6NQLoAG82IdMkwAcfUAqhrDjiYr7+NwRMnLBy5NAkKuFnMYJDM4vLIM+MXr1w3KA6fGHiwR0pYFvOJtCyaWoMqV8bqGJU36z+IuxbU1XhBV4ocadLY/YKx6/sTx380nKzRh4sPHzJf/Dt8ENEME+BDMhhj/7BUxE0SL1fWY0F5Imr7QWJpAKXID26pB0gqVKCV4yQjb1zohIHNs9GaTzQD5hoPEDsFR2hUmYprjW4MxIMpL51cTXxi11BdD8BFSJ1VuxUPdm7iBZjPvdNMUM9jcfFu/8Yr/WrWFn4gyKBQGDsPFIb1qeSt8UhB+X4LDsCDkxv37sMXNnjAG6H5GRPgQRGReFxv86E8YMaBElEuAvFkSYoi3QcUYXGbxRs7pkv6j1fmG5gyY2ql+yRTYXNOiObjyMHOahX2N0MysHuVjAmYIhj5TVQYoLBGCxP8oZbx4kUBgimsNAccVBln5lCoOa9ElalxMQGhb5wIdcWFIvlQByAgjW1ISBJKmYr5RPqdUUcrZLQwFFoIJ3MehU0cXconAstnzv54NPPPdVce3GfucLAeAKo8dkRyBG5doPsGTMIBBjBZH6QHtNHsABSGZZyK/ACYCvNwImGOyIXyaHqOG93n11NZJFlG24eNQz8i678pZA80URebJGWZH6A22AnFoc6iOJoYql3Pjq4NxIMJT+wSVOfhg+bt5hG1zthM/XAxn8i1Y+ssklGJ5oLqr5hiB0b3q1la8CC7dx9mvvpO/7Og8Eo1R9yhhAc8biTmV0+YQIBZiKi9ARaCzMAug9w78PBBD3nY9FJvGkpI0P0SHkh9UBzTiMZ5wBSyyiwAzOFMxXSgWOiSjDyfTnjAvGlffjtLFICVBdRYx4jAl/QHHIggo25FTlBpCdwsIhJrxIt0gXPhqaz45VQA1+Z3/1/MJxoD06b/Bu/OHWYNdWaBuhOubavE2g4r5RMNjuxV9LseOFhAQMbGoDlfSfZiPIYJ0DSOFQbE4sw3Exb6sLfHGGyVwKa43mikvZHvv2f07AEiTDcyO5slnug2lcLj4gJFQHo9gIHGNZz7aTygMQ0VeAYB/WoBkXhhlM5PlqdL7MAUmj5d4ebhgVYUzRmxePnavwsTFmC53ntnXIApRMYftHIgHhgDU2e1s/8SPyAeA/GAoXDv7B6EcbRWwVknTOCVcMRflvCAx4UDmVAIcQ1eRO1N6E+QYGSnonufL2EAUwYcHqKZZsHgGURC2ul+zTzoQrdc4FMpRrqs0QOtgUpspsgPQFUkHTdIAgjzdqrMvJkyXQgBc7YIiIBjw9RcNpGtEyZQa5qIPxURCaBE+nPDdNNC8QOtozw5IUd4MR0IE3PSRfNvrDWQQXm7liFbWhMCSrYAJDKhhI3eTqEMJFUmKFjb51PYU2Tr1hRy/kAkr0sMyJv7860UbpgAIR8cwMypM703dTkFlBdw6EIx5KFA3kJpoE5/DumPjTp7GOBKFQ1fX/heGjRQho1kYmkWLtwsORv6IL9SJhhfTh7YOsuEx3aKUMclf2JQIzmzdeIPxQXLcO2P7dhdjHn5mg2GmHNeUgZzA/GAYzknoW7bVcYDHjfnD936qd85aueRuH41O0X3zt/5oIwePuz3s9ZLBpZNmRBaWMQD/NcDUS7QsJPspf2kJ4Qf0sYPCKB1YbZr9BgKAbkGIa94ti5QxKLkeikRQWUpVaBSPbCWkRgaNS62AB7oqw+5zTltpANcPIOS5dW9Yj7RPxqoDKYe5g8j/NuoSYE0hLOYjEMwmKwPZQ9EO+PvzZIZGw/qXVweENJx4ZBHc8EZohWEa8NmsSYt1JQTkkY41lK2T7lUmGhA87j43W0qW3OqoAsnTuuuyXC8Ub9jzWn1pJlFRDJV+qwb7vOaaYMRzNjDdERXiguWBs4KvwVLa6ypJumM6qlTPtbFRT+ByUELtSzaMmEsxfLxs3X4k6/X7/tOt4yEuh+ycBs/GLNoaJ1+t9myqR6IB4iEPisf6b9euupvY8mkFQ84zKg1+ETCg7x4n117Fw8G0f2cO6RUfmYv7ae/EYzgB6MGCWgSj9561nq9Ah/FDPghAeUFirnTQz5MCJ03FnQhcwb/h2AUBUjxhTWulX6a83A0myaCkbHB0mkxnygij5KJ1RKgMGPONNMbLfKztT7R6HprNHmDZA9cen44W6IWFhVJRH51E1RkL3zW+g06NzUYfupecbFOKKM0wJsxEQDiwxHy9Y3NCW1FXVAmu/HMRgApCzQ2UeDWLCMX65EMXA7z6HtwxnVSOkgrMh7oRjHkobLyBkIdgQdkkvEXkMOGroNZO6XHiyscXDueoAXKBvL1zFnLdceFMhWzulEBuP88XRjrt8S3xp1TTX7huPjd+BQF5NIB7IyA585faZg5x5rrdjNNu/7AGCATr96xbSUxYyzEkPIo08SDyBsul1y8UTf33BnUxh/kE1vTgWOaeAFwwP/+8kL/Rtmo/I4lfjC6ySfmbEWuBAhtXKcBmpUSTy7mEy1Y5kpImseAcgIuWyJdObqtHklEHsujK6Y+R6C5SfID1BmgaFWUE83VAijUl9H4MGukxvnhTDx0o0h1c30iAGFE2TMbTELzeMDG4noj9umtNFGcpP+mMVZ4mhJTpabHLt1WYrnI0IAjh3sAJXJIy6WphAdF38je0dgItLZogqwGjbRAmdlJzQAXIxbzn2uzxQuMy3qrNIABPKuhgK0EA4nINoBcWJxwTXh8p3D5eVyiyLMkQJ9l7mJlayqy/eod/xRR/XtvvxBjUyzy1Eel1QItAp45a9kh5qyS2rpLrENtMqAeKYoYdh4VgmAAXBh7xlLROnGEcRqIB++9/WK34DlXS096eq8oORsYL0gHRqywXFIW831yLi9sapKkz3HqwfnEjydAyX4yNHDVZGiEtxIMAXVURC6fPhzRynoNLqzdV4/UVj6wa9OFXMhkJqh2jhUye9GNXdvwIMdG1JUTyc7V30E8VktjUXTvvM25fcij+WFIK/TKK42FcSg6V1jnrdmNMSJdyYmZfLcukfD5GUgzN8pxknHJpSS8eBFQSI4w7zPJaPJ45G0ZdCPXsRcFkJ5zibFktlnKo4nkcx13xoXiGOif7H4kXGKJZJZIh9lFYZUjj0us+pYEUBSrmfmD/ZaIN1s2ZQ+xxjJvC0d68cr1ogUEYO7919OnLVHdv9ecaeV39ZZlom6o3xQv8czergpAPkEkFy9YfwA/mDR2/5451298//13okqSi8/Cp8kPot8XrBTNDoZShz7PNxtCBuYT896FvP0g+MLyvRpFcfNebflEKb5jluolIXL9QcaDSEiukNx7MX9AQGQ0l06qm+PoUOeV001X+NBiPnHXvpCH/sOBCHVW7quIWjGlA4vJeX3rf+vpzdpKrtPMqVLF0EUBDCTzAEhEgNYwoP6bEy7WaBIANLw9wpu1hppy7O1YMvHkoi3IH+Qwj1kz5bwFJddym1530RpJRi5QWStaiFV3G9bKvTFAsopjoJmidrESi5ScZwOPHrFAuLQYlzVTS4pl58ATkEAkY6D0WMGvixC0X7KOUrWusdgphAcQ8OjhC3RNefILx4YQS4iQm7YW11jefv3aqIIS6mu2Kgg7CAgTjFzTLB8XMxhNZqYaf8uWAWGTnzs8qh3s3xC1N5F7jE0x5HG/evuXe1FK/WYPvf/elCi3nCodMBgPZDF14foUH0xfPpGJGsgjG43r6n+DB1GPtMyAfCIB2CoHAxe6e5hWaghmk5g4YBAeUKZjGg8UznSV3ttDwHKpILpoTBEvrNxn/6v0opRcbu0nayyWFzIQruu0NZt11lVSDZbu9N+tNZoECDa0IDvWbMp5a4ZBVuRRdO/wYEzzcHjk5XuUJ2q5P9Yr+ioaEwYeiYbPpEgFV7igSY8TclyzVctMFTmSN+RSOgTD74JNC1Ryi8ZFC1vLztmCbH7ETTWwordqdd9+7fIQlFcCtaa86rtwqk/UApXDPPGksfuE7ir2jd2XtZBYe16khWQh189ftGqwFBk9+MDNP7DP3LHOlnOsZqY4Bm+Pvyi8sGUSggAI2h/l1/vP083mFTdA4ESqhCc++bu01aAGEy0QbCi3Vjndz1jK9crjL0h9ru0fcECmKU3iIV9TXjxh+viBaTR4040HbFzfsHEal004q3N4pyUH4MGvM6A0myRPasjFscv2BHAqrRsgKEeuhMz2n1nJUc2mST+pfJEfdMP/PizwRi3KtzLs/dpKLKNCcrleyiuDiQfpv3w6DRQWFCMWeBDRSoMJrC97Y0pG1QkReLfyg1xemZfGIqO7VkKivHWTgOIYgKrIYjVLppIRUXJde2z6n+nOQW2DqJ+5oDX2OtbWiGjawyOCl5yTxTITxTFgjdz7uc0uc4akTn/iU3vGnj+ldjyVGSrmUCzS2JJntwAXz6QVNNr8E2kwu0m26pWeF937y9d9JoqaGREyEdUAtUVaQhSQ2yAku1Hcsm3grCVYIpj09N5Rk6QFapa1Sn3We1OeStH9b0YNN2c0nnuf8uKJUdxsnUVL7KTqv167+1+iQqRozs9ftNqQdQR1SdNaMhyGB3IFaavm0JBn4pO7R83WQDwwkIc2eJAdyVF9BkWlI584iO5n/c8P5/2Oee+j/EHRGhlI3mWdLdFDNBRKubVOCmiH1grJpRICnfDxXsqDAFDHiNxSQDu14cHRTXklAcBEC9zGBhIxJGrcyg/yHm/0BrAwaeCSu6ILBBRbYHCY8h8aa5RL4GzdtPT4plWtkJYTEMgFckUzubS8AQjFhREGs7jKowWovrdpOgzgzgTcSg2BS64EKuZQTI/wnwVamLFQwQp5ZqkARBvgGJ9ibp2Jaq7ifkkHxQyxTbPGAt5al/Bn2bx9529Z8XzowHkDfQTbBFlr4NYl4nTDFiVnIhTLifQPNxh34+fCnUMgEKZ+uf9SPVgUANI92O+dp05C5Ou+PVrqE997a2w14dEdAnmUXPdfzkEwRhBq8HpjHa0gF/2XndaTnz8mn4tQxgPaRVWz6R7ZsNNDF+65NTYhxi5aIwMJbrBkz6l29zct1LtlcMoJiFHpzUf1CTisEUDN6YmbgB0G7bjOaRC/a4GmE8Ct00BdGLiDIudO8p5v2JhruQFKKyLlBcu8FMKsczUc68w8oVVA8IN1EqggWKguw7KXia/MOysg045tRRw5DYilUGMuLc5D+cWs3Srao9rCf6NrIUr9gYUZAJLK8UdFWpB5e8GJbSXXTDTigvohAQbfGLuHfpSKHPlJ9YsA5/dt2Txe1xKBYxsEF3BAXg06iVyeO3/F2EBc3M8ED+UIGIv9fAp8URpuvke0T4yAHDYOX+FYJSUd3n9vUnxY/qT/Ydc7b95S0/9/jmLw4fzgxzNXr9/zjfgAT9yfwQjv/MToaBnGYjaK5vzaXdsFmZranAUdr9/77e4xJ9OMF65pNnsAVuMibhh/yz8MjhcCDxbu4QFXRvcP/HBvjxNrFKT/YuaWeOGQRkDXKy+UHuTO0EDOh4AiHuQd19GCxXvEOntkiuaWR2td4aDnsRVzmR46+cmANB8m8OLFFjCQMSv39mow4VgmWDf9rWXQqVVArj/IKQ/GdP3X09IZ1f1DU+BoHIpdUNXAUHK0QhM5VwZEL1RDIOKHLTIgh5KrHqKkarOU0ct7GyXsrX60VkzvVZuookbN9jDX5mbGVzcVAaJ33SwKMO/JfGeNauHAgxpgYldh/VPmny3w2sX9TIhDbDvC0ndLWxKF+zAil+O/etvWMSZnl5Lz6B2v+8b934sPW9UjMF8OEHA6C9rTHH0y1flI9QMQx56mcTd+PghF//X6fd8OsgH2mvKC4UskapDCO9cD99a4s3ve+datK9EMlHbdm0qRh5vzxJrqv37vN7ujL/CySGm79ouXr52WClKOYdr5AxskYxfJD0ZOf/6A0eSYIUz5Q8mMeS0km1uTBvt5CQ92zAKaIPugPgv0MGfi5oSLgLJTPpFl8R43OLyPYMMCLWG1xRbk9ca8nhZVEM3qBpxgytCpVYD/yGurDIY3zsecsdKclNCNX8zSQjBigbaJVnL0zhoJCUxYO41TMeBQg5GLeZAMv3Ppwv8Q0KQI7T4tJuMASt7kkLcg5CDcTzjBX+jG6LaEJG6g2XlLJmuMHbbbpN1VLNNG4mJxnxQQboCZiw9iY9SWaeuN0wdcyDi3r4vFI98syImXLQdosgG0oP/+uxMrdbwie2dHFTcLM9HgB2csFZuFUZv+yy7k2GFZt7L/wK1eF+p+2XrgA/o7/tbkTN9765lIhbBIaOQyM8WSKk20VRuhysXPohhMraH51Wt3fz26VzRnSGRdRQmBPV2AFKjOUP4AKqt2kP6ZoXpl7orVRYy8UCLW+zZYgNZxfW5e6WcjW/DAgznpdlATHxCY8YAgalwUsPOovrTfYr0DFNyw4YCmRa0CNC0vyhHSLbH9+1Rmzm/gC2ymiAcE5MyFD8ID3olOWGuOCtlVmpKqtgxGLpfgIyxe80D2NoZnXj/FEpCpmM0DKHnLDQTKzWdQsWW72VGhdUV+ADS9kRlHpfQXe0uHfgKV2FWzVUvlvJFH729uNj5ZZ7z4s6nwmZFhq+ivmKK4m8j8U1spQSUD+HCcWnb9RtWbD/1XaObYM5aMRbsiPzBVqoUfrUmE89EAB17w/vvvdot57m7qccRURUDJ4Q1os/JvgWLS2H3rkH/NsEiufcqLJ8XAFuOFJ8csEhwgthvU4wGhINDDNcXP9YpaAqFL1hilQ+Nu+kI9YF9JR7t8K8VKvYDjpmFWOcQ0pT6AiDSIfEnpeuuVswbjgS0W2Fj09+UzUqz0wvHTxgP8d/8FezkzeLB/ww8yHjAkOeWfjOy0BxxxRtLCvY2SrJNAmgoTWgX8ZlRvLY2qmhVAK498QrPeBhfYzE/bBACRDCgMivEov+UzEFEq3FpCQcCYZsGSm4ua5c1SDT/X7m8aaFxaU6K5uO/UZhNcPjvNT0w96P6iAyqmw+a3SJXSfj+/OebJT4SDqRNWTI0b6TgHZvu0g9CeHU33b4xIVotu8NrGqVjQBEgk4YW33uqNInnu3aGcbAI+FE8fwIs4VuvtvLAAW/XLGw/8e1p7q1uAR0vaFVf7KBBfKOT1ZrgATMbf+qU41kgcIa5mcOeUtiPBfcsisprgTHfikKk6QrFY6TQCRBzYmKFhArzp8eM+EgEFkhHrKs2Osl4KYNd2c5YrcVAKEEE0AOmbD/90mDm/+dCPhpxaNsQ08wlNebX3jfv/rXr/vYmVIw3ydUc6e7YdDyAQXAQs2NoM8QO5goOa85EObuKGYOsLJCMSuVPjH49oyx98tHc+klnJuXa4QBCwYTOtgJLjA/epq/f2M1lvE5QTtHubeycgl1hyoN7M+hgTC43KwGUTWylm87jsXMiYT3PFCbQi7+Nwt57AIODoL+6DDW5olA9npqEEtybjgg9slWh+LrGESpwuv4l4M/Piyjc652H7mikLgyGIeXNrjImCcXvF3YWgij/klZktY4ILyaR/EFkswvGlYimNOY6zoLZNZxyI3C1YEvD4MR9JR7/9MK16FIv7wJQ3AxILFMIfbIVKswuu3y4j5n1qSUAcOFnjAbt3ozLQpzn/I52heNMWNRF/Pi/iTXUkbHNAAAojg+HGBaa+UB0EpLiDIjaE1Z4INrBECzQYCZYiBJjy0inxguKJLJlkRAK2JlcENLY/Y/FCFzhqZMpH2+Tr/XffHIAHszYZ/CZ3SFlyNQAdgRF4Mjz4UQkPooBhod6qXn/JsfQYX0DQ6Db3TgBdyHU3PPGZTdltrs3xf63ZPCZ6YnNKY2zJWjmZtC3bsf7WVEm2nsAgAZErA89ct7d3J+8aCGyoDYxfLBb/axrzBWFMNp/WxCoFHpCagRFeXHsPfrBpCvFBuzf6O2HBHBGUc77AprifydSxwmCn305HnjEkFJ/us05KpkXF487Mcd5VKLSlzlJfVrxk/CkW4Uy6GC9olnjZPmfhDiaiJXQ/9L/21IxNUtJsFY8z4f+9ifrCA1yJSQu4UwJihVgNbFIDww9Q0E+jbX8fi9P/d968tW9X0XmxfFiMFziSSLhsmU6g4MKFOJYMHOQ+6ZkDYulAYVP/DsOuACM78YnfxlzDhTik/Rdlc8Zgy+sLTV9deYWnHxNsjOqHs4F4YEoRqsnPHhrpUaffT3xy9LTjhf2bVT20L045Xz0ZFwLOL+7S5t4JoAuHNfECMIl9fmsny8xVca3ZPCbaX7ggRoidBGv0Tl8gdGDFNBTKOyfyvqa8i+K0ZntW63koIhHAkbcr541AzBpTj53HX0zJiKJ71zd4kA8OUW7MxXuQTtzUHIUGcIpr76hLzurHkQWfTUcA0oVHmxN/aapBLQKKZsV+pmZTFNsXvdIBQuIwhW3TksERi7es/rO8Sxt2Ql0FHxBJjtHtnCT/VtwwzaVrcj7KJI68a75/Qn7ttbu+FgU9AIaQ4ecrr5+2J8aiRHN6JXrDwb4z4c7q7VcvC2sEKsX1RnAdG0PzcXc1GmHtL162djXuhs9GpdALF68RY1PcTQRUURrJlrxx2si//doVQ8uJ7tquHLFIvPeXFOetWfkchIgVHvl5VAlpVet5KPksZTOiC8ZAblFu4fX7vpv/vx0PXrvzq90NkeBMK0xlXkb+K/46lf+jArj12FS/YWfaY5D3+fc7HDAP7vtP6GoVEAdqbZFyBhSKI6HSNLPfIxUFnNtsyxRcRPqvftjae7YRDpeptwpgfVnP46ifbdLOonygCoHMvVVArPB9pTlEpDlxwRjIr/GT0gLApXVrHhwgAPEGX3BQtaBtSW6eqjn9vNwCpYP6GMnY7VLQIfHAH8pisBWCWwV4AHS71R/AQXU4/ZG7vGKrAEm4tLb43Vh7DbJRRzHvvze5emv8RTU72TwOIWtdLhSZTXj0l/HdC1ia/nqjzAZchEzNV6qUWyC9IZORippXiJxinFTV1GdCqOmOFyK8uWaDdIjKRmn75sD8wf9wPGCF+ZykaeNBczh7xgJOJrhhc+L1dLfg4iabRZm4uTjJcfMZEABQQHlUAXw5WSiB5w06FyfQ6HPJKwu28hlikSKvY+sIzr87sl2ANwEM1ujt3ohkWCaz/5+m3vSDAQKYsiZqgcBD0BFni9b2wKydv96/8j9MAIdKSHClL6fwhxGl7br7BCb0xwrDBMidMmVNNnhR+VD7Q9VBMpsZka7vOwNgKKD8dvbqpWs+Xb1657ahOGIGgyeX4Bty7Gno33owRID8oQ/nXcX6ba1Rt3AikJ7N2WyUz09svoclXzKbAJZ2KniarvxB3mqRs7k5d5I2Rmzy/yoegLR+bjjdAuIUwy063e1o/edjTVNArj+IY7+27R2HOkMtyMuF+SDOafOD5tyDfibq9zi4/aep/HTguXn5VLZYoNw4vZn90404zL9W6f4y2+EtaFb1tQKkRXGb5fMD5ombJU6Ni0MEaF7etg1YojqwfrPAm5eyWDEQkVREWWezwmfA8jHpSgd8/Zxgg4X2t2KIAAZjCwL40oW8ZAgnopa5ZuqKe4otSDHRbLFQ6dJn/c8HVzPn5mTjISeSDImZpq56QPdBW5rKXhmBFHGxC4AjFy0pr071Rxd2M5t9JQXtmjj+5i/2cODmL+QCpmmvL/z14kEoVXO+7AwL4BfDGrfsDKG30y0gBxp5xe+CTTv/a4N4deOlKNTULRnW3yFd2Dj5SLkkkTvH0l/EMrAFQDQHHfyhm7fuL+Qpuvf+38VIHnRsOkPiuQYiEvOV/vSmvGCr7zYICsxxheu2HyAAJ87fApMPaoYRSq4xdOBiLIoCMDDmCnXygSIe1irMnS5gbHxma7WwN9mC1TPbObpQzlLVYeQTjIoCOBBZG0mHbJUsMm9FQHGUD/R/hcIQAdZWm69U69r/1PsbtWqgHuQERL6UVOWrKbv8v4AHJac63QLow4Wb/gUC8gGc/1sgrT8dPN0CaJ2bWnO2U5v84IeboIOKu5uilukMODZIrMRygA0wdADJmHpAh72RN2aywRHETCoBDl+ga4lT05yh/KBGIN5Y2iNXSTIiLh2sUeOm1K7TuvaOG8gf6nOcAL9VonpuY9Ac71EWoL/ZgSovBqLZ9s1CPhukuDwQMVPdBUTKGusLl60dG4DsmBD+vzvpvvjd8Qb9X2rSfdgpTOCsf18z+1eP1d1B8dKYCMJa8cDDk587Yipzfrb7O1Cd5nnrjnGylzP2ONaEq3ugQk19ZkiR/oflD/4iAeds0A4m0xSQg45sgedsMIOAgpVIiUU68Osj8v6WdgH5CJOcM8QRaJ0Kodhp5PzxjQfhweYpOsmUngBY4M00EKCgOwMTEOyeReIF0l9iaTfhzFtrBuKBDYJvv3pJlBx7sybzym7B+ZsP/7g9XgAeKL83Ml0JeRZKoJsQXwpXXB7IK555G5IHLE42AXd3V5EMbz+0dwXgAJaDZPQ9nDKY/9n9XeWDHRRTf8Py0PMPXjk7ciUTn9ojHs5nIr07+bF4WGpkmvsbdcWcT315sKlF+P94MMMRy4Z/AR5kitP/ZR8zTjCaL3VwX/+NEdNeoBgSiNbWl0uLGFr+/oWBCUnuWzGfh+TO5BCdTJQXLJovCm6PF+IraGshCIWHCXE+CCGKHG/83sjBLYivIa2FeNjt7A83KyWk/4tMhn3/gv07Hs5N97M5PCRa4cvUb2hrgSUQC3TOTLNEkIXk73Wd+ORuwR2MQ0s+ccGAK1/4qkzCbkq3tVatkEuI7+3ZZgCoevufv5O+sMXD+fwTh7FqkfoDPwcqkpZoQd7TmfOKHm5Oaxny+f8Gd0TMRx2PYswAAAAASUVORK5CYII=",this.texture_source_category="built_in";break;case"textures/particle/soul":e="data:image/png;base64,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",this.texture_source_category="built_in";break;case"textures/particle/campfire_smoke":e="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAADACAYAAAANzeNOAAAClklEQVRo3u2Z624UMQyF91URgoqi3ujSG70tqgCB4JWDXOlUpx47dmbUVav1j6NMMj6fnZ0ks9uuWmurJVoVIAZcnx23WQAxRmYXALPWYsDnj+9aCiCBIpjQpgEMYaWnoE2eOayglnIBFgHuLr801hBAmyPQs87hp/etB7AgLsCDyXh3ChLAYhjGwg8xazYBvI11NXUe7B5g823doGEAmyOQaZR3YRYyMR/tf3AhGDMBYoS87IC4UxCzBKC1siOJC+hVgjEXwBAvM5vdx8iBuqqhlRiZaze++Ha+PmuiWQCYtRYDLNCwuQvImDVk8jVfbp4c7LlGxJgAMUIIRMtgaUMAmwEUsdkEMAgGQKDuU+BAS6l1wMGesbbztgDyPni4u3hSGsAmiGFdgGXWkNkAazpDZmsaT+b10X7KjDgTwBmsa5ilNQEcoCG4D5kAngoqEmmzCeAqPHEi9zHqYC9zuJS9jHUebBPwc3PVtIZ/cLAZ/RBgZe5VMmxOA/QUMHZ+cvAMMjGzUYJ1H+0EgGAE4dqTOQXc0MEa1n0KvYza3F0HvbJrN74pwO/vNw1KA2DAWymCuBk9uYDIyNXMAoguTg8fZQLkBmdCX1oZg9kF4CDVZgh/+ugCEKCNXnZ3HSBQt7WZCjAL8OfhtkFDADHgQIkg3awA4frq63FLAXTmXhUTgGTh7LqfAmgBlJoCIBo2ex1EZ0LthQK8PODvj/sGDQHEIBuIATfnp7mlzCYNSm1nyaSzowKrCnMKCGal/kkDM1fC/VqJBdhFwO3luv37tXnU8DcUNuN6GCCSzICkv+JoCDRUQXQG1EIqwK4AsAewiYbPAz4TeuYUoHcWhJ9BZK51UIACbAuAA2X47WxBFlVQj/G1A/4D2cRpqoNd7bwAAAAASUVORK5CYII=",this.texture_source_category="built_in";break;default:e=M,this.texture_source_category="placeholder"}this.texture.image.src=e};if("function"==typeof this.scene.fetchTexture){let t=this.scene.fetchTexture(this);t instanceof Promise?t.then((t=>{e(t)})):e(t)}else e();return this}}C.types={identifier:{type:"string"},file_path:{type:"string"},events:{type:"object"},curves:{type:"object"},space_local_position:{type:"boolean"},space_local_rotation:{type:"boolean"},space_local_velocity:{type:"boolean"},variables_creation_vars:{type:"string",array:!0},variables_tick_vars:{type:"string",array:!0},emitter_rate_mode:{type:"string"},emitter_rate_rate:{type:"molang"},emitter_rate_amount:{type:"molang"},emitter_rate_maximum:{type:"molang"},emitter_lifetime_mode:{type:"string"},emitter_lifetime_active_time:{type:"molang"},emitter_lifetime_sleep_time:{type:"molang"},emitter_lifetime_activation:{type:"molang"},emitter_lifetime_expiration:{type:"molang"},emitter_events_creation:{type:"string",array:!0},emitter_events_expiration:{type:"string",array:!0},emitter_events_distance:{type:"object"},emitter_events_distance_looping:{type:"object",array:!0},emitter_events_timeline:{type:"object"},emitter_shape_mode:{type:"string"},emitter_shape_offset:{type:"molang",array:!0,dimensions:3},emitter_shape_radius:{type:"molang"},emitter_shape_half_dimensions:{type:"molang",array:!0,dimensions:3},emitter_shape_plane_normal:{type:"molang",array:!0,dimensions:3},emitter_shape_surface_only:{type:"boolean"},particle_appearance_size:{type:"molang",array:!0,dimensions:2},particle_appearance_material:{type:"string"},particle_appearance_facing_camera_mode:{type:"string"},particle_appearance_direction_mode:{type:"string"},particle_appearance_speed_threshold:{type:"number"},particle_appearance_direction:{type:"molang",array:!0,dimensions:3},particle_update_expression:{type:"string",array:!0},particle_render_expression:{type:"string",array:!0},particle_direction_mode:{type:"string"},particle_direction_direction:{type:"molang",array:!0,dimensions:3},particle_motion_mode:{type:"string"},particle_motion_linear_speed:{type:"molang"},particle_motion_linear_acceleration:{type:"molang",array:!0,dimensions:3},particle_motion_linear_drag_coefficient:{type:"molang"},particle_motion_relative_position:{type:"molang",array:!0,dimensions:3},particle_motion_direction:{type:"molang",array:!0,dimensions:3},particle_rotation_mode:{type:"string"},particle_rotation_initial_rotation:{type:"molang"},particle_rotation_rotation_rate:{type:"molang"},particle_rotation_rotation_acceleration:{type:"molang"},particle_rotation_rotation_drag_coefficient:{type:"molang"},particle_rotation_rotation:{type:"molang"},particle_lifetime_max_lifetime:{type:"molang"},particle_lifetime_kill_plane:{type:"number",array:!0,dimensions:4},particle_lifetime_expiration_expression:{type:"molang"},particle_lifetime_expire_in:{type:"string",array:!0},particle_lifetime_expire_outside:{type:"string",array:!0},particle_texture_size:{type:"number",array:!0,dimensions:2},particle_texture_height:{type:"number"},particle_texture_path:{type:"string"},particle_texture_mode:{type:"string"},particle_texture_uv:{type:"molang",array:!0,dimensions:2},particle_texture_uv_size:{type:"molang",array:!0,dimensions:2},particle_texture_uv_step:{type:"molang",array:!0,dimensions:2},particle_texture_frames_per_second:{type:"number"},particle_texture_max_frame:{type:"molang"},particle_texture_stretch_to_lifetime:{type:"boolean"},particle_texture_loop:{type:"boolean"},particle_color_mode:{type:"string"},particle_color_static:{type:"color"},particle_color_interpolant:{type:"molang"},particle_color_range:{type:"number"},particle_color_gradient:{type:"object",array:!0},particle_color_expression:{type:"molang",array:!0,dimensions:4},particle_color_light:{type:"boolean"},particle_collision_toggle:{type:"boolean"},particle_collision_enabled:{type:"molang"},particle_collision_collision_drag:{type:"number"},particle_collision_coefficient_of_restitution:{type:"number"},particle_collision_collision_radius:{type:"number"},particle_collision_expire_on_contact:{type:"boolean"},particle_collision_events:{type:"object",array:!0},particle_events_creation:{type:"string",array:!0},particle_events_expiration:{type:"string",array:!0},particle_events_timeline:{type:"object"}},b.Config=C;const B={roundTo(e,t){var i=Math.pow(10,t);return Math.round(e*i)/i},randomab:(e,t)=>e+Math.random()*(t-e),radToDeg:e=>e/Math.PI*180,degToRad:e=>Math.PI/(180/e),clamp:(e,t,i)=>(e>i&&(e=i),(e<t||isNaN(e))&&(e=t),e),roundTo(e,t){var i=Math.pow(10,t);return Math.round(e*i)/i},getRandomEuler:()=>new r(B.randomab(-Math.PI,Math.PI),B.randomab(-Math.PI,Math.PI),B.randomab(-Math.PI,Math.PI))};const z={x:new a(1,0,0),y:new a(0,1,0),z:new a(0,0,1),n:new a(0,0,0)};function I(e,t){let i=e.indexOf(t);i>=0&&e.splice(i,1)}const E={r:255,r:255,b:255,a:1},k=(new s).setComponents(0,1,0,0);class D{constructor(e){this.emitter=e,this.geometry=new o(2,2),this.material=this.emitter.material,this.mesh=new n(this.geometry,this.material),this.position=this.mesh.position;let t=new Float32Array(16).fill(1);this.geometry.setAttribute("clr",new l(t,4)),this.speed=new a,this.acceleration=new a,this.facing_direction=new a,this.add()}params(){var e=this.emitter.params();return e["variable.particle_lifetime"]=this.lifetime,e["variable.particle_age"]=this.age,e["variable.particle_random_1"]=this.random_vars[0],e["variable.particle_random_2"]=this.random_vars[1],e["variable.particle_random_3"]=this.random_vars[2],e["variable.particle_random_4"]=this.random_vars[3],e}add(){this.emitter.particles.includes(this)||(this.emitter.particles.push(this),this.emitter.getActiveSpace().add(this.mesh)),this.age=this.loop_time=0,this.current_frame=0,this.random_vars=[Math.random(),Math.random(),Math.random(),Math.random()];var e=this.params();this.position.set(0,0,0),this.lifetime=this.emitter.calculate(this.emitter.config.particle_lifetime_max_lifetime,e),this.initial_rotation=this.emitter.calculate(this.emitter.config.particle_rotation_initial_rotation,e),this.rotation_rate=this.emitter.calculate(this.emitter.config.particle_rotation_rotation_rate,e),this.rotation=0;var t=this.emitter.config.emitter_shape_surface_only;if("box"===this.emitter.config.emitter_shape_mode){var i=this.emitter.calculate(this.emitter.config.emitter_shape_half_dimensions,e);if(this.position.x=B.randomab(-i.x,i.x),this.position.y=B.randomab(-i.y,i.y),this.position.z=B.randomab(-i.z,i.z),t){var r=Math.floor(B.randomab(0,3)),s=Math.floor(B.randomab(0,2));this.position.setComponent(r,i.getComponent(r)*(s?1:-1))}}else if("entity_aabb"===this.emitter.config.emitter_shape_mode){i=new a(.5,1,.5);if(this.position.x=B.randomab(-i.x,i.x),this.position.y=B.randomab(-i.y,i.y),this.position.z=B.randomab(-i.z,i.z),t){r=Math.floor(B.randomab(0,3)),s=Math.floor(B.randomab(0,2));this.position.setComponent(r,i.getComponent(r)*(s?1:-1))}}else if("sphere"===this.emitter.config.emitter_shape_mode){var o=this.emitter.calculate(this.emitter.config.emitter_shape_radius,e);this.position.x=t?o:o*Math.random(),this.position.applyEuler(B.getRandomEuler())}else if("disc"===this.emitter.config.emitter_shape_mode){o=this.emitter.calculate(this.emitter.config.emitter_shape_radius,e);var n=Math.random()*Math.PI*2,l=t?o:o*Math.sqrt(Math.random());this.position.x=l*Math.cos(n),this.position.z=l*Math.sin(n);var p=this.emitter.calculate(this.emitter.config.emitter_shape_plane_normal,e);if(!p.equals(z.n)){var h=(new c).setFromUnitVectors(z.y,p);this.position.applyQuaternion(h)}}this.speed.set(0,0,0);var _=this.emitter.config.particle_direction_mode;if("outwards"==_&&this.emitter.inherited_particle_speed)this.speed.copy(this.emitter.inherited_particle_speed);else{"inwards"==_||"outwards"==_?"point"===this.emitter.config.emitter_shape_mode?this.speed.set(1,0,0).applyEuler(B.getRandomEuler()):(this.speed.copy(this.position).normalize(),"inwards"==_&&this.speed.negate()):this.speed=this.emitter.calculate(this.emitter.config.particle_direction_direction,e).normalize();let t=this.emitter.calculate(this.emitter.config.particle_motion_linear_speed,e);this.speed.x*=t,this.speed.y*=t,this.speed.z*=t}if(this.position.add(this.emitter.calculate(this.emitter.config.emitter_shape_offset,e)),"locator"==this.emitter.parent_mode&&(this.position.x*=-1,this.position.y*=-1,this.speed.x*=-1,this.speed.y*=-1),"world"!=this.emitter.parent_mode&&this.emitter.config.space_local_position&&!this.emitter.config.space_local_rotation&&(this.speed.x*=-1,this.speed.z*=-1),"entity_aabb"===this.emitter.config.emitter_shape_mode&&(this.position.x+=1),this.emitter.local_space.parent&&("locator"==this.emitter.parent_mode&&this.speed.applyQuaternion(this.emitter.local_space.getWorldQuaternion(new c)),this.emitter.config.space_local_rotation||this.position.applyQuaternion(this.emitter.local_space.getWorldQuaternion(new c)),!this.emitter.config.space_local_position)){let e=this.emitter.local_space.getWorldPosition(new a);this.position.addScaledVector(e,1/this.emitter.scene.global_options._scale)}this.setFrame(0);for(let e of this.emitter.config.particle_events_creation)this.emitter.runEvent(e,this);return this.tick()}tick(e){var t=this.params();let i=1/this.emitter.scene.global_options.tick_rate;for(var r of this.emitter.config.particle_render_expression)this.emitter.Molang.parse(r,t);let s=this.age;if(this.age+=i,this.loop_time+=i,this.lifetime&&this.age>this.lifetime&&this.expire(),this.emitter.calculate(this.emitter.config.particle_lifetime_expiration_expression,t)&&this.expire(),"dynamic"===this.emitter.config.particle_motion_mode){var o=this.emitter.calculate(this.emitter.config.particle_motion_linear_drag_coefficient,t);if(this.acceleration.copy(this.emitter.calculate(this.emitter.config.particle_motion_linear_acceleration,t)),this.emitter.config.space_local_position?"locator"==this.emitter.parent_mode&&(this.acceleration.x*=-1,this.acceleration.y*=-1):"world"!=this.emitter.parent_mode&&(this.acceleration.x*=-1,this.acceleration.z*=-1),this.acceleration.addScaledVector(this.speed,-o),this.speed.addScaledVector(this.acceleration,i),this.position.addScaledVector(this.speed,i),this.emitter.config.particle_lifetime_kill_plane.find((e=>e))){var n=this.emitter.calculate(this.emitter.config.particle_lifetime_kill_plane,t),l=(new a).copy(this.position).addScaledVector(this.speed,-i),c=(new a).copy(this.position);this.emitter.config.space_local_position&&"locator"==this.emitter.parent_mode&&(l.x*=-1,l.y*=-1,c.x*=-1,c.y*=-1);var _=new p(l,c);if(n.intersectsLine(_))return this.expire(),this}if(this.emitter.ground_collision&&this.emitter.config.particle_collision_toggle&&(!this.emitter.config.particle_collision_enabled||this.emitter.calculate(this.emitter.config.particle_collision_enabled,t))){let e=this.emitter.config.particle_collision_collision_drag,t=this.emitter.config.particle_collision_coefficient_of_restitution,r=Math.max(this.emitter.config.particle_collision_collision_radius,1e-4),s=k,o=new h(this.position,r),n=(new a).copy(this.position).addScaledVector(this.speed,-i),l=new p(n,this.position),c=s.intersectsLine(l);if(c&&s.intersectLine(l,this.position),c||s.intersectsSphere(o)){if(this.emitter.config.particle_collision_events.length){let e=this.speed.length();for(let t of this.emitter.config.particle_collision_events)"object"==typeof t&&t.event&&(t.min_speed&&t.min_speed>e||this.emitter.runEvent(t.event,this))}if(this.emitter.config.particle_collision_expire_on_contact)return this.expire(),this;this.position.y=r*Math.sign(n.y),this.speed.reflect(s.normal),this.speed.y*=t,this.speed.x=Math.sign(this.speed.x)*B.clamp(Math.abs(this.speed.x)-e*i,0,1/0),this.speed.z=Math.sign(this.speed.z)*B.clamp(Math.abs(this.speed.z)-e*i,0,1/0)}}}else"parametric"!==this.emitter.config.particle_motion_mode||e||(this.emitter.config.particle_motion_relative_position.join("").length&&this.position.copy(this.emitter.calculate(this.emitter.config.particle_motion_relative_position,t)),this.emitter.config.particle_motion_direction.join("").length&&this.speed.copy(this.emitter.calculate(this.emitter.config.particle_motion_direction,t)),this.emitter.config.space_local_position&&"locator"==this.emitter.parent_mode&&(this.position.x*=-1,this.position.y*=-1));if("dynamic"===this.emitter.config.particle_rotation_mode){var m=this.emitter.calculate(this.emitter.config.particle_rotation_rotation_drag_coefficient,t),d=this.emitter.calculate(this.emitter.config.particle_rotation_rotation_acceleration,t);d+=-m*this.rotation_rate,this.rotation_rate+=d*i,this.rotation=B.degToRad(this.initial_rotation+this.rotation_rate*this.age)}else"parametric"===this.emitter.config.particle_rotation_mode&&(this.rotation=B.degToRad(this.emitter.calculate(this.emitter.config.particle_rotation_rotation,t)));if("direction"!=this.emitter.config.particle_appearance_facing_camera_mode.substr(0,9)&&"lookat_direction"!=this.emitter.config.particle_appearance_facing_camera_mode||("custom"==this.emitter.config.particle_appearance_direction_mode?this.facing_direction.copy(this.emitter.calculate(this.emitter.config.particle_appearance_direction,t)).normalize():this.speed.length()>=(this.emitter.config.particle_appearance_speed_threshold||.01)&&this.facing_direction.copy(this.speed).normalize()),!e){var f=this.emitter.calculate(this.emitter.config.particle_appearance_size,t);if(this.mesh.scale.x=f.x||1e-4,this.mesh.scale.y=f.y||1e-4,"animated"===this.emitter.config.particle_texture_mode){var g=this.emitter.calculate(this.emitter.config.particle_texture_max_frame,t);if(this.emitter.config.particle_texture_stretch_to_lifetime&&g)var u=g/this.lifetime;else u=this.emitter.calculate(this.emitter.config.particle_texture_frames_per_second,t);Math.floor(this.loop_time*u)>this.current_frame&&(this.current_frame=Math.floor(this.loop_time*u),g&&this.current_frame>=g?this.emitter.config.particle_texture_loop&&(this.current_frame=0,this.loop_time=0,this.setFrame(0)):this.setFrame(this.current_frame))}else this.setFrame(0);if("expression"===this.emitter.config.particle_color_mode){var A=this.emitter.calculate(this.emitter.config.particle_color_expression,t,"array");this.setColor(...A)}else if("gradient"===this.emitter.config.particle_color_mode){var v=this.emitter.calculate(this.emitter.config.particle_color_interpolant,t),y=this.emitter.calculate(this.emitter.config.particle_color_range,t);A=function(e,t){let i=0;if(e.forEach(((e,a)=>{e.percent<=t&&(i=a)})),e[i]&&!e[i+1])return x(e[i].color).toRgb();if(!e[i]&&e[i+1])return x(e[i+1].color).toRgb();if(e[i]&&e[i+1]){var a=(t-e[i].percent)/(e[i+1].percent-e[i].percent);return x.mix(e[i].color,e[i+1].color,100*a).toRgb()}return E}(this.emitter.config.particle_color_gradient,v/y*100);this.setColor(A.r/255,A.g/255,A.b/255,A.a)}else{A=x(this.emitter.config.particle_color_static).toRgb();this.setColor(A.r/255,A.g/255,A.b/255,A.a)}}for(let e in this.emitter.config.particle_events_timeline){let t=parseFloat(e);t>=s&&t<this.age&&this.emitter.runEvent(this.emitter.config.particle_events_timeline[e],this)}return this}expire(){for(let e of this.emitter.config.particle_events_expiration)this.emitter.runEvent(e,this);this.remove()}remove(){return I(this.emitter.particles,this),this.mesh.parent&&this.mesh.parent.remove(this.mesh),this.emitter.dead_particles.push(this),this}delete(){this.mesh.parent&&this.mesh.parent.remove(this.mesh),this.geometry.dispose()}setColor(e,t,i,a=1){let r=this.geometry.getAttribute("clr");r.array.set([e,t,i,a,e,t,i,a,e,t,i,a,e,t,i,a]),r.needsUpdate=!0}setFrame(e){if("full"!==this.emitter.config.particle_texture_mode){var t=this.params(),i=this.emitter.calculate(this.emitter.config.particle_texture_uv,t),a=this.emitter.calculate(this.emitter.config.particle_texture_uv_size,t);if(e){var r=this.emitter.calculate(this.emitter.config.particle_texture_uv_step,t);i.addScaledVector(r,e)}this.setUV(i.x,i.y,a.x||this.emitter.config.particle_texture_size[0],a.y||this.emitter.config.particle_texture_size[1])}else this.setUV(0,0,this.emitter.config.particle_texture_size[0],this.emitter.config.particle_texture_size[1])}setUV(e,t,i,a){let r=this.geometry.getAttribute("uv");i=(e+i-0)/this.emitter.config.particle_texture_size[0],a=(t+a-0)/this.emitter.config.particle_texture_size[1],e=(e+(i>0?0:-0))/this.emitter.config.particle_texture_size[0],t=(t+(a>0?0:-0))/this.emitter.config.particle_texture_size[1],r.array.set([e,1-t,i,1-t,e,1-a,i,1-a]),r.needsUpdate=!0}}b.Particle=D;const Q=new a,F=new e,P=["particles_alpha","particles_opaque","particles_blend","particles_add"];function R(e){switch(e.mode){case"catmull_rom":var t=[];return e.nodes.forEach(((e,i)=>{t.push(new m(i-1,e))})),new v(t);case"bezier":t=[];return e.nodes.forEach(((e,i)=>{t.push(new m(i/3,e))})),new A(...t)}}class X extends class{constructor(){this.events={}}dispatchEvent(e,t){var i=this.events[e];if(i)for(var a=0;a<i.length;a++)"function"==typeof i[a]&&i[a](t)}on(e,t){this.events[e]||(this.events[e]=[]),this.events[e].push(t)}removeEventListener(e,t){this.events[e]&&I(this.events[e],t)}}{constructor(t,i,a=0){super(),this.scene=t,this.child_emitters=[],t.emitters.push(this),this.config=i instanceof C?i:new C(t,i,a),this.Molang=new y,this.Molang.variableHandler=(e,t)=>this.config.curves[e]&&function(e,t,i,a){var r=e.Molang.parse(t.input,a),s=e.Molang.parse(t.range,a);if("bezier_chain"==t.mode&&(s=1),(r=r/s||0)===1/0&&(r=0),"linear"==t.mode){r*=c=t.nodes.length-1;var o=Math.floor(r),n=r%1,l=t.nodes[o+1]-t.nodes[o];return t.nodes[o]+l*n}if("catmull_rom"==t.mode){let a=e._cached_curves[i];var c;a||(a=e._cached_curves[i]=R(t));var p=(1+(r*=c=t.nodes.length-3))/(c+2);return a.getPoint(p).y}if("bezier"==t.mode){let a=e._cached_curves[i];return a||(a=e._cached_curves[i]=R(t)),a.getPoint(r).y}if("bezier_chain"==t.mode){let e=t.nodes.slice().sort(((e,t)=>e.time-t.time)),i=0;for(;i<e.length&&!(e[i].time>r);)i++;let a=e[i-1],s=e[i];a||(a={time:0,right_value:0,right_slope:0}),s||(s={time:1,right_value:0,right_slope:0});let o=s.time-a.time;var h=[new m(a.time+0*o,a.right_value),new m(a.time+o*(1/3),a.right_value+a.right_slope*(1/3)),new m(a.time+o*(2/3),s.left_value-s.left_slope*(1/3)),new m(a.time+1*o,s.left_value)];return new A(...h).getPoint((r-a.time)/o).y}}(this,this.config.curves[e],e,t);let r=t.global_options._scale;this.local_space=new e,this.local_space.scale.set(r,r,r),this.global_space=new e,this.global_space.scale.set(r,r,r),this.material=new _({uniforms:{map:{type:"t",value:this.config.texture},materialType:{type:"int",value:1}},vertexShader:"#define GLSLIFY 1\nattribute vec4 clr;varying vec2 vUv;varying vec4 vColor;void main(){vColor=clr;vUv=uv;vec4 mvPosition=modelViewMatrix*vec4(position,1.0);gl_Position=projectionMatrix*mvPosition;}",fragmentShader:"#define GLSLIFY 1\nvarying vec2 vUv;varying vec4 vColor;uniform sampler2D map;uniform int materialType;void main(void){vec4 tColor=texture2D(map,vUv);if(materialType==0){if(tColor.a<0.5)discard;tColor.a=1.0;}else if(materialType==1){tColor.a=1.0;}else{tColor.a=tColor.a*vColor.a;}gl_FragColor=vec4(tColor.rgb*vColor.rgb,tColor.a);}",vertexColors:!0,transparent:!0,alphaTest:.2}),this.particles=[],this.dead_particles=[],this.creation_time=0,this.parent_emitter=null,this.age=0,this.view_age=0,this.enabled=!1,this.loop_mode=a.loop_mode||t.global_options.loop_mode,this.parent_mode=a.parent_mode||t.global_options.parent_mode,this.ground_collision="boolean"==typeof a.ground_collision?a.ground_collision:t.global_options.ground_collision,this.inherited_particle_speed=null,this.pre_effect_expression=null,this.random_vars=[Math.random(),Math.random(),Math.random(),Math.random()],this.tick_values={},this.creation_values={},this._cached_curves={},this.updateMaterial()}getActiveSpace(){return this.config.space_local_position&&this.local_space.parent?this.local_space:this.global_space}clone(){let e=new b.Emitter(this.scene,this.config);return e.loop_mode=this.loop_mode,e}params(){var e={"variable.entity_scale":1};return e["variable.emitter_lifetime"]=this.active_time,e["variable.emitter_age"]=this.age,e["variable.emitter_random_1"]=this.random_vars[0],e["variable.emitter_random_2"]=this.random_vars[1],e["variable.emitter_random_3"]=this.random_vars[2],e["variable.emitter_random_4"]=this.random_vars[3],e}calculate(e,t,i){let r=e=>this.Molang.parse(e,t);var o;return e instanceof Array?"array"==i?(o=[],e.forEach((e=>{o.push(r(e))}))):4===e.length?o=(new s).setComponents(r(e[0]),r(e[1]),r(e[2]),r(e[3])):3===e.length?o=new a(r(e[0]),r(e[1]),r(e[2])):2===e.length&&(o=new m(r(e[0]),r(e[1]))):"color"==i||(o=r(e)),o}updateConfig(){this.updateMaterial()}updateFacingRotation(e){if(0==this.particles.length)return;const t=new c,i=new a;let r;this.config.particle_appearance_facing_camera_mode.substring(0,6),r=this.particles[0].mesh.parent.getWorldQuaternion(t).invert(),this.particles.forEach((t=>{switch("direction"==this.config.particle_appearance_facing_camera_mode.substring(0,9)&&("YXZ"!==t.mesh.rotation.order&&(t.mesh.rotation.order="YXZ"),i.copy(t.facing_direction),1==i.y?i.y=-1:-1==i.y&&(i.y=1,i.z=-1e-5)),"lookat_direction"==this.config.particle_appearance_facing_camera_mode&&("XYZ"!==t.mesh.rotation.order&&(t.mesh.rotation.order="XYZ"),i.copy(t.facing_direction)),this.config.particle_appearance_facing_camera_mode){case"lookat_xyz":t.mesh.lookAt(e.position);break;case"lookat_y":var a=i.copy(e.position);Q.set(0,0,0),t.mesh.localToWorld(Q),a.y=Q.y,t.mesh.lookAt(a);break;case"rotate_xyz":t.mesh.rotation.copy(e.rotation),t.mesh.quaternion.premultiply(r);break;case"rotate_y":t.mesh.rotation.copy(e.rotation),t.mesh.rotation.reorder("YXZ"),t.mesh.rotation.x=t.mesh.rotation.z=0,t.mesh.quaternion.premultiply(r);break;case"direction_x":var s=Math.atan2(i.x,i.z),o=Math.atan2(i.y,Math.sqrt(Math.pow(i.x,2)+Math.pow(i.z,2)));t.mesh.rotation.set(0,s-Math.PI/2,o);break;case"direction_y":s=Math.atan2(i.x,i.z);var n=Math.atan2(i.y,Math.sqrt(Math.pow(i.x,2)+Math.pow(i.z,2)));t.mesh.rotation.set(n-Math.PI/2,s-Math.PI,0);break;case"direction_z":s=Math.atan2(i.x,i.z),n=Math.atan2(i.y,Math.sqrt(Math.pow(i.x,2)+Math.pow(i.z,2)));t.mesh.rotation.set(-n,s,0);break;case"lookat_direction":F.position.copy(t.mesh.position),F.quaternion.setFromUnitVectors(z.x,i),i.copy(e.position),t.mesh.parent.add(F),F.updateMatrixWorld(),F.worldToLocal(i),t.mesh.parent.remove(F),t.mesh.rotation.set(Math.atan2(-i.y,i.z),0,0,"XYZ"),t.mesh.quaternion.premultiply(F.quaternion);break;case"emitter_transform_xy":t.mesh.rotation.set(0,0,0);break;case"emitter_transform_xz":t.mesh.rotation.set(-Math.PI/2,0,0);break;case"emitter_transform_yz":t.mesh.rotation.set(0,Math.PI/2,0)}t.mesh.rotation.z+=t.rotation||0}))}start(){this.age=0,this.view_age=0,this.enabled=!0,this.initialized=!0,this.scene.space.add(this.global_space);let e=this.params();for(var t of(this.Molang.resetVariables(),this.active_time=this.calculate(this.config.emitter_lifetime_active_time,e),this.sleep_time=this.calculate(this.config.emitter_lifetime_sleep_time,e),this.random_vars=[Math.random(),Math.random(),Math.random(),Math.random()],this.creation_values={},this.config.variables_creation_vars))this.Molang.parse(t,e);"string"==typeof this.pre_effect_expression&&this.Molang.parse(this.pre_effect_expression,e),this.dispatchEvent("start",{params:e}),this.updateMaterial();for(let e of this.config.emitter_events_creation)this.runEvent(e);return"instant"===this.config.emitter_rate_mode?this.spawnParticles(this.calculate(this.config.emitter_rate_amount,e)):"manual"===this.config.emitter_rate_mode&&this.spawnParticles(1),this}tick(e){let t=this.params(),{tick_rate:i}=this.scene.global_options,a=1/i;for(var r of(this._cached_curves={},this.config.variables_tick_vars))this.Molang.parse(r,t);this.config.particle_update_expression.length&&this.particles.forEach((e=>{let t=e.params();for(var i of this.config.particle_update_expression)this.Molang.parse(i,t)})),this.dispatchEvent("tick",{params:t}),e||this.updateMaterial(),this.particles.forEach((t=>{t.tick(e)}));let s=this.age;if(this.age+=a,this.view_age+=a,this.enabled&&"steady"===this.config.emitter_rate_mode){var o=this.calculate(this.config.emitter_rate_rate,t)/i,n=1/o;o=Math.round(this.age*i)%Math.round(n)==0?Math.ceil(o):Math.floor(o),this.spawnParticles(o)}this.dispatchEvent("ticked",{params:t,tick_rate:i});for(let e in this.config.emitter_events_timeline){let t=parseFloat(e);t>=s&&t<this.age&&this.runEvent(this.config.emitter_events_timeline[e])}return this.child_emitters.slice().forEach((t=>{t.tick(e)})),"expression"===this.config.emitter_lifetime_mode?(this.enabled&&this.calculate(this.config.emitter_lifetime_expiration,t)&&this.end(),!this.enabled&&this.calculate(this.config.emitter_lifetime_activation,t)&&this.start()):this.parent_emitter||"looping"!=this.loop_mode&&("auto"!=this.loop_mode||"looping"!=this.config.emitter_lifetime_mode)?this.enabled&&B.roundTo(this.age,5)>=this.active_time&&this.end():(this.enabled&&B.roundTo(this.age,5)>=this.active_time&&this.end(),!this.enabled&&B.roundTo(this.age,5)>=this.sleep_time&&this.start()),this.parent_emitter&&0==this.particles.length&&this.age>this.active_time&&(I(this.parent_emitter.child_emitters,this),this.delete()),this}stop(e=!1){return this.enabled=!1,this.age=0,e&&(this.particles.slice().forEach((e=>{e.remove()})),this.child_emitters.slice().forEach((e=>e.delete())),this.child_emitters.splice(0)),this.dispatchEvent("stop",{clear_scene:e}),this}end(){this.stop(),this.dispatchEvent("end");for(let e of this.config.emitter_events_expiration)this.runEvent(e);return this}jumpTo(e){let{tick_rate:t}=this.scene.global_options,i=Math.round(this.view_age*t),a=Math.round(e*t);if(("looping"==this.loop_mode||"auto"==this.loop_mode&&"looping"==this.config.emitter_lifetime_mode)&&(a%=Math.round(this.active_time*t)-1),i==a)return;a<i?this.stop(!0).start():this.initialized||this.start();let r=this.view_age;for(;Math.round(this.view_age*t)<a-1&&(this.tick(!0),!(this.view_age<=r));)if(r=this.view_age,!this.material)return;return this.tick(!1),this.material?(this.child_emitters.slice().forEach((t=>{t.creation_time>e&&(t.delete(),I(this.child_emitters,t))})),this):void 0}updateMaterial(){let e=this.config.particle_appearance_material;this.material.uniforms.materialType.value=P.indexOf(e),this.material.side="particles_alpha"===e||"particles_opaque"===e?d:f,this.material.blending="particles_add"===e?g:u}playLoop(){return this.initialized&&0!=this.age||this.start(),this.paused=!1,clearInterval(this.tick_interval),this.tick_interval=setInterval((()=>{this.tick()}),1e3/this.scene.global_options.tick_rate),this}toggleLoop(){return this.paused=!this.paused,this.paused?(clearInterval(this.tick_interval),delete this.tick_interval):this.playLoop(),this}stopLoop(){return clearInterval(this.tick_interval),delete this.tick_interval,this.stop(!0),this.paused=!0,this}spawnParticles(e){if(!e)return this;if("steady"==this.config.emitter_rate_mode){var t=this.calculate(this.config.emitter_rate_maximum,this.params())||0;t=B.clamp(t,0,this.scene.global_options.max_emitter_particles),e=B.clamp(e,0,t-this.particles.length)}else e=B.clamp(e,0,this.scene.global_options.max_emitter_particles-this.particles.length);for(var i=0;i<e;i++){if(this.dead_particles.length)var a=this.dead_particles.pop();else a=new D(this);a.add()}return e}delete(){this.child_emitters.slice().forEach((e=>e.delete())),this.child_emitters.splice(0),this.particles.concat(this.dead_particles).forEach((e=>{e.delete()})),this.particles.splice(0,1/0),this.dead_particles.splice(0,1/0),this.local_space.parent&&this.local_space.parent.remove(this.local_space),this.global_space.parent&&this.global_space.parent.remove(this.global_space),I(this.scene.emitters,this),this.material.dispose(),delete this.material,delete this.parent_emitter}runEvent(e,t){if(e instanceof Array){for(let i of e)this.runEvent(i,t);return}this.dispatchEvent("event",{event_id:e,particle:t});let i=this.config.events[e],r=async i=>{if(i.sequence instanceof Array)for(let e of i.sequence)r(e);if(i.randomize instanceof Array){let e=function(e){let t=e.reduce(((e,t)=>e+t.weight||1),0),i=Math.random()*t,a=0;for(let t of e)if(a+=t.weight||1,i<=a)return t}(i.randomize);e&&r(e)}if(i.expression&&this.Molang.parse(i.expression,this.params()),i.sound_effect&&this.dispatchEvent("play_sound",{sound_effect:i.sound_effect,particle:t,event_id:e}),i.particle_effect){let r,s=i.particle_effect.effect,o=this.scene.child_configs[s];if(!this.scene.child_configs[s]&&this.scene._fetchParticleFile){o=this.scene.child_configs[s]=new C(this.scene);let e=this.scene.fetchParticleFile(s,this.config,o),t=e=>{e&&(e.json?(o.file_path=e.file_path,o.setFromJSON(e.json||e)):o.setFromJSON(e))};e instanceof Promise?t(await e):e&&t(e)}if(o){r=new X(this.scene,o,{}),r.creation_time=this.age,r.parent_emitter=this,r.pre_effect_expression=i.particle_effect.pre_effect_expression,this.child_emitters.push(r),"emitter_bound"==i.particle_effect.type?r.parent_mode=this.parent_mode:"particle_with_velocity"==i.particle_effect.type&&t&&(r.inherited_particle_speed=(new a).copy(t.speed));let e=new a;if(t?t.mesh.getWorldPosition(e):this.getActiveSpace().getWorldPosition(e),this.local_space.parent&&!this.config.space_local_position){let t=this.local_space.getWorldPosition(new a);e.add(t)}r.getActiveSpace().position.copy(e),r.start()}this.dispatchEvent("play_child_particle",{particle_effect:i.particle_effect,config:o,child_emitter:r,event_id:e})}};i&&r(i)}}b.Emitter=X;export default b;
